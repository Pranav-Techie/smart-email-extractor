<!DOCTYPE html>
<html>
<head>
    <title>Quick Lead Scraper</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 40px; background: #f9f9f9; }
        input, button { padding: 10px; font-size: 16px; }
        #emails { margin-top: 20px; white-space: pre-wrap; }
        #download { display: none; margin-top: 10px; }
    </style>
</head>
<body>
    <h1>Quick Lead Scraper</h1>
    <form id="scrape-form">
        <input type="text" id="url" name="url" placeholder="https://example.com" style="width: 300px;">
        <button type="submit">Start Scraping</button>
    </form>
    <div id="emails"></div>
    <a id="download" href="/download" download>⬇️ Download CSV</a>

    <script>
        document.getElementById('scrape-form').onsubmit = async (e) => {
            e.preventDefault();
            const url = document.getElementById('url').value;
            document.getElementById('emails').innerText = "⏳ Scraping...";
            document.getElementById('download').style.display = "none";

            const res = await fetch('/scrape', {
                method: 'POST',
                headers: {'Content-Type': 'application/x-www-form-urlencoded'},
                body: `url=${encodeURIComponent(url)}`
            });

            const data = await res.json();
            if (data.error) {
                document.getElementById('emails').innerText = "" + data.error;
            } else if (data.emails && data.emails.length > 0) {
                document.getElementById('emails').innerText = 
                    data.emails.map(e => `${e.email} (score: ${e.score})`).join("\n");
                document.getElementById('download').style.display = "inline-block";
            } else {
                document.getElementById('emails').innerText = " No emails found.";
            }
        };
    </script>
</body>
</html>
